<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Real Images</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .product-card { width: 200px; height: 250px; border: 1px solid #ccc; margin: 10px; display: inline-block; }
        .product-image { width: 100%; height: 150px; background: #f0f0f0; position: relative; overflow: hidden; }
        .product-image img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; }
        .image-placeholder { width: 100%; height: 100%; background: linear-gradient(45deg, #4a5d23, #2d5016); display: flex; align-items: center; justify-content: center; font-size: 2rem; color: white; position: absolute; top: 0; left: 0; }
        .debug-info { background: #f9f9f9; padding: 10px; margin: 10px 0; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <h1>Test de Imágenes Reales</h1>
    
    <div class="test-section">
        <h2>Test 1: Imagen directa (debería funcionar)</h2>
        <div class="product-card">
            <div class="product-image">
                <img src="assets/images/img/prerroll_donut_wizard_trees_0.jpg" alt="Prerroll Test" onload="console.log('Imagen cargada correctamente')" onerror="console.log('Error cargando imagen:', this.src)">
            </div>
            <div>Prerroll Wizard Trees</div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Con función getImageUrl (simulada)</h2>
        <div class="product-card">
            <div class="product-image">
                <img id="test-img" alt="Test" onload="console.log('Imagen con función cargada')" onerror="console.log('Error con función:', this.src)">
                <div class="image-placeholder" style="display: none;">
                    <i>🌿</i>
                </div>
            </div>
            <div>Test con función</div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Datos reales de la API</h2>
        <div id="api-test"></div>
    </div>
    
    <div class="debug-info" id="debug-info">
        <h3>Debug Info:</h3>
        <div id="debug-content"></div>
    </div>
    
    <script>
        // Simular la función getImageUrl
        function getImageUrl(imagePath) {
            console.log('getImageUrl called with:', imagePath);
            if (imagePath.startsWith('http://') || imagePath.startsWith('https://')) {
                return imagePath;
            }
            if (imagePath.startsWith('img/')) {
                return `assets/images/${imagePath}`;
            }
            return imagePath;
        }
        
        // Test con función
        document.getElementById('test-img').src = getImageUrl('img/prerroll_donut_wizard_trees_0.jpg');
        
        // Test con datos reales de la API
        async function testApiData() {
            try {
                const response = await fetch('https://mp-bot-3lij.onrender.com/api/catalog');
                const data = await response.json();
                
                if (data.success && data.data.categories.varios) {
                    const prerrolls = data.data.categories.varios.products.filter(p => 
                        p.name.includes('Prerolls') && p.images && p.images.length > 0
                    );
                    
                    console.log('Prerrolls encontrados:', prerrolls);
                    
                    let html = '';
                    prerrolls.forEach(product => {
                        html += `
                            <div class="product-card">
                                <div class="product-image">
                                    <img src="${getImageUrl(product.images[0])}" alt="${product.name}" 
                                         onload="console.log('API image loaded:', this.src)" 
                                         onerror="console.log('API image error:', this.src)">
                                    <div class="image-placeholder" style="display: none;">
                                        <i>🌿</i>
                                    </div>
                                </div>
                                <div>${product.name}</div>
                            </div>
                        `;
                    });
                    
                    document.getElementById('api-test').innerHTML = html;
                }
            } catch (error) {
                console.error('Error fetching API data:', error);
                document.getElementById('debug-content').innerHTML += '<br>Error fetching API: ' + error.message;
            }
        }
        
        // Ejecutar test
        testApiData();
        
        // Debug info
        document.getElementById('debug-content').innerHTML = 
            'Current URL: ' + window.location.href + '<br>' +
            'Image path test: ' + getImageUrl('img/prerroll_donut_wizard_trees_0.jpg') + '<br>' +
            'Direct image URL: assets/images/img/prerroll_donut_wizard_trees_0.jpg';
    </script>
</body>
</html>
